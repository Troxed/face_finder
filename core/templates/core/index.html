{% extends 'core/base.html' %}
{% block title %}Face Finder{% endblock %}

{% block content %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<div class="max-w-4xl mx-auto">
  <form class="mt-4" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="flex justify-center flex-row gap-6">
      <div class="relative h-44 w-44 sm:h-72 sm:w-72">
        <h1 style="text-align: center; font-size: large; text-decoration: underline;">Face to search for</h1>
        <input type="file" id="person-photo" name="person_photo" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
        <label for="person-photo" class="absolute inset-0"></label>
        <div id="person-photo-preview" class="h-full w-full bg-gray-200 rounded-lg flex items-center justify-center">
          <span class="text-gray-500 text-sm">Select an image</span>
        </div>
      </div>
      <div class="relative h-44 w-44 sm:h-72 sm:w-72">
        <h1 style="text-align: center; font-size: large; text-decoration: underline;">Photo to search</h1>
        <input type="file" id="group-photo" name="group_photo" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
        <label for="group-photo" class="absolute inset-0"></label>
        <div id="group-photo-preview" class="h-full w-full bg-gray-200 rounded-lg flex items-center justify-center">
          <span class="text-gray-500 text-sm">Select an image</span>
        </div>
      </div>
    </div>
    <div class="mt-14 text-center">
      <button type="submit" class="py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Find Face</button>
    </div>
  </form>
</div>

<style>
  #person-photo-preview, #group-photo-preview {
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
  }

  #person-photo-preview:hover, #group-photo-preview:hover {
    opacity: 0.8;
  }
</style>

<script>
  function previewImage(input, img) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      reader.onload = function(e) {
        img.css('background-image', `url(${e.target.result})`);
        img.find('span').hide();
      }
      reader.readAsDataURL(input.files[0]);
    }
  }

  $('#person-photo').on('change', function() {
    previewImage(this, $('#person-photo-preview'));
  });

  $('#group-photo').on('change', function() {
    previewImage(this, $('#group-photo-preview'));
  });
</script>

{% endblock %}
